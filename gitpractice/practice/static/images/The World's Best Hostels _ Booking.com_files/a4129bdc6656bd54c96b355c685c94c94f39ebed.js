var _i_=this._i_||function(){},_r_=this._r_||function(e){return e},_sp_=this._sp_||function(e){B.et.customGoal("cDPPESHbfNFVTAYZSQDZET",1),B.reportError({message:"SPDR function called - "+e},"SPDR")};_i_("e4e:d18a9e29"),B.when({events:"ready",condition:B.et.track("AEDEZRdPLbbHVJNSZWbBaCFJVKe")&&B.env.b_personalized_layout_id}).run(function(e){_i_("e4e:712489dd"),setTimeout(function(){_i_("e4e:dca24cc5"),function(e){_i_("e4e:18b860ff");var t=e("utils/throttled"),i=e("utils/inviewport"),n=[".js-ds-layout-events-postcards",".js-ds-layout-events-promo",".js-ds-layout-events-promote_articles",".js-ds-layout-events-bh_carousel",".js-ds-layout-events-bh_promotions"],r=n.reduce(function(e,t,i){return _i_("e4e:c9e48e1c"),e.push({el:$(t),index:i+1}),_r_(e)},[]),a=t(function(){_i_("e4e:2da38ffb");var t=[];r.forEach(function(e){_i_("e4e:6dedbc44"),i(e.el)?_(B.env.b_personalized_layout_id,"view",e.index,B.env.b_index_personalized_layout_exp_name,B.env.b_index_personalized_layout_exp_variant):t.push(e),_r_()}),r.length?r=t:$(window).off("scroll",a),_r_()},10);function _(e,t,i,n,r){_i_("e4e:b6791c4a"),$.ajax({type:"post",dataType:"json",url:"/sendlayoutevents",data:{layout:e,action:t,widget:i,exp_name:n,exp_variant:r}}),_r_()}a(),$(window).scroll(a),n.forEach(function(e,t){var i,n;_i_("e4e:9b321c9e"),i=e,n=t+1,_i_("e4e:57b8f9f0"),$(i).click(function(){_i_("e4e:537def33"),_(B.env.b_personalized_layout_id,"click",n,B.env.b_index_personalized_layout_exp_name,B.env.b_index_personalized_layout_exp_variant),_r_()}),_r_(),_r_()}),_r_()}(e),_r_()},5e3),_r_()}),_r_(),B.when({events:"ready"}).run(function(e){_i_("e4e:e0fa7ad5");var n=e("jquery");n(".js-lp-sh-dismiss").on("click",function(e){_i_("e4e:c9ec7514"),e.preventDefault();var t=n(this).parents(".js-lp-sh-btn-group"),i=t.data("sh_id");if(!i)return _r_();t.remove(),B.et.customGoal("AEDEZRdJfaAUaJfWHT",1),n.ajax({url:"/hide_search_hist",data:{id:i},success:function(){_i_("e4e:0b4f6bdf"),n(".js-lp-sh-dismiss").length||(n(".lp-search-history-bar").remove(),B.et.customGoal("AEDEZRdJfaAUaJfWHT",2)),_r_()}}),_r_()}),_r_()}),_i_("e4e:bd6b1de5"),B.when({events:"ready",action:"index",experiment:"BZEFUUKIFcPMdTULHaO"}).run(function(){_i_("e4e:5f3390eb");var e=document.getElementsByClassName("save-heart");function i(e){_i_("e4e:23c1b77a"),Array.prototype.forEach.call(e,function(e){_i_("e4e:21b0aa8d");var t=window.BUI.getInstance(e);t.close(),t.unmount(),_r_()}),_r_()}Array.prototype.forEach.call(e,function(e){_i_("e4e:36d0e6ae");var t=window.BUI.getInstance(e);t.props.onAfterOpen=function(){_i_("e4e:3e69c600"),window.BUI.initComponents(document.body),$.cookie("heart-survey-seen")&&window.BUI.getInstance(e).close(),_r_()},t.props.onAfterClose=function(){_i_("e4e:d381fddf"),i(document.getElementsByClassName("save-heart")),_r_()},_r_()}),$.cookie("heart-survey-seen")&&i(e),$(".save-heart").click(function(e){_i_("e4e:a04fa2de"),e.stopPropagation(),B.et.customGoal("BZEFUUKIFcPMdTULHaO",1),$.cookie("heart-survey-seen","true"),this.classList.contains("active-heart")?this.classList.remove("active-heart"):this.classList.add("active-heart"),_r_()}),_r_()}),_r_(),B.when({events:"ready",action:"index",condition:B.env.b_is_south_east_asia_deals_focus_user,experiment:"dOLFTIFdAHEAeOaZDXe"}).run(function(e){_i_("e4e:39b047e7");var i=e("jquery"),t=i(".js-nbt_weekend_deals");t.on("mouseenter mouseleave",".js-nbt_weekend_deal",function(e){_i_("e4e:aebe9266");var t="mouseenter"===e.type;i(this).toggleClass("nbt_weekend_deal_selected",t),_r_()}),_r_()}),B.when({events:"ready",action:"index",experiment:"adUTWALOLOLOXKFbUBWeFcOHT"}).run(function(e){_i_("e4e:0ec7fb85");var a=e("jquery");({count:0,card:"li",wrapper:"#pending-property-reviews",close:"button.bui-banner__close",init:function(){if(_i_("e4e:ee6631e3"),this.removeDiscardedCards(),this.showMaxThreeCards(),this.count=a(this.wrapper).find(this.card).length,0==this.count)return a(this.wrapper).parents(".lp_flexible_layout_content_wrapper.pe-full-content-wrapper").remove(),a(this.wrapper).remove(),_r_(!0);a(this.wrapper).show(),this.updateWidth(),this.bindEvents(),_r_()},showMaxThreeCards:function(){_i_("e4e:636077cc"),a(this.wrapper).find(this.card).map(function(e,t){_i_("e4e:431f8fc7"),2<e&&a(t).remove(),_r_()}),_r_()},bindEvents:function(){_i_("e4e:474b7209"),a(this.wrapper).on("click",this.close,this.handleClose.bind(this)),_r_()},removeDiscardedCards:function(){_i_("e4e:4e616b49"),a(this.wrapper).find(this.card).map(function(e,t){_i_("e4e:de0a5172");var i="pending_"+a(t).data("js-id");a.cookie(i)&&a(t).remove(),_r_()}),_r_()},handleClose:function(e){_i_("e4e:8834e035"),this.count=this.count-1;var t=a(e.currentTarget).data("js-id");return a.cookie("pending_"+t,1,{expire:30}),a(this.wrapper).find(this.card+"[data-js-id="+t+"]").remove(),_r_(0==this.count?a(this.wrapper).remove():this.updateWidth())},updateWidth:function(){_i_("e4e:841ae26b");var e=100/this.count,t=16*(this.count-1)/this.count;a(this.wrapper).find(this.card).css("width","calc("+e+"% - "+t+"px)"),this.updateNames(this.count<=2?1:2),this.updateHeight(),_r_()},updateNames:function(i){_i_("e4e:7b30a675");var n=this;a(this.wrapper).find(this.card).find("[data-js-name]").map(function(e,t){return _i_("e4e:cf0c7671"),_r_(n.ellipsisLines(t,i))}),_r_()},updateHeight:function(){_i_("e4e:5c6571fd");var i=0;return a(this.wrapper).find(this.card+" > div").height("auto"),a(this.wrapper).find(this.card+" > div").map(function(e,t){_i_("e4e:00e37058"),i=Math.max(a(t).height(),i),_r_()}),_r_(a(this.wrapper).find(this.card+" > div").height(i))},ellipsisLines:function(e,t){_i_("e4e:9aea13a3");var i=a(e),n=i.data("js-name"),r=window.getComputedStyle(i[0]).lineHeight.replace("px","");for(i.html(n);i.height()>r*(t||1)+1;)i.text(function(e,t){return _i_("e4e:a5464122"),_r_(t.replace(/\W*\s(\S)*$/,"â€¦"))});return _r_(!0)}}).init(),_r_()});